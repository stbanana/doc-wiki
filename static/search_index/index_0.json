{"/modbusX/zh_hans/overview/ç‰¹æ€§.html":{"title":"åº“ç‰¹æ€§","content":"# åº“ç‰¹æ€§ 1. âš¡**ä¸é˜»å¡**ï¼šä½¿ç”¨åº“ tickï¼Œç¦æ­¢é˜»å¡ 2. ğŸª¶**ä¸å çº¿ç¨‹**ï¼šå• tick é©±åŠ¨æ•´ä¸ªä¸»ä»é“¾ï¼Œä»¥ä»»ä½•æ–¹å¼å‘¨æœŸè¿è¡Œ tick 3. ğŸŒ **ä¸å ä¸­æ–­**ï¼šè‡ªç”±çš„ port ç»‘å®šï¼Œä»¥ä»»æ„æ–¹å¼ç®¡ç†æ•°æ®æµ 4. ğŸ’ª**å¤šä¸»å¤šä»**ï¼šä»»ä½•ä¸»æœºæˆ–ä»æœºéƒ½æ˜¯ç‹¬ç«‹å¯¹è±¡ï¼Œå¯åœ¨ç¨‹åºä¸­å¼€å¯ä»»æ„å¤šä¸ªä¸»ä»æœº 5. ğŸ—½**å¯„å­˜å™¨åœ°å€è¡¨ä¸å†…å­˜åœ°å€ä»»æ„æ˜ å°„**ï¼šæœ¬åº“çš„é‡è¦ç‰¹æ€§ï¼Œè§£å†³ modbus è™šæ‹Ÿåœ°å€ä¸å®é™…å˜é‡ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œä½¿å¾—å¼€å‘æ›´ä¸ºç®€å•ä¸”è‡ªç”±ï¼Œæ•´ä¸ªåº“çš„ä½¿ç”¨å®Œå…¨å›´ç»•è¿™ä¸ªæ˜ å°„è¡¨å±•å¼€ï¼Œæœªæ¥çš„ç»´æŠ¤åŒæ ·åªéœ€ç»´æŠ¤æ˜ å°„è¡¨ã€‚ 6. âš–ï¸**ä¸åŒçš„åœ°å€æ˜ å°„æŸ¥æ‰¾æ—¶é—´ï¼Œç›¸å·®åº”å½“ä¸è¶…è¿‡ 500 ä¸ªæ—¶é’Ÿå‘¨æœŸ**ï¼šå¾ˆéš¾è¯´æ˜¯å®ç°äº†ï¼Œç”±äº modbus æœ€å¤šä¹Ÿå°± 0xFFFF ä¸ªè™šæ‹Ÿåœ°å€ï¼Œæ‰€ä»¥é‡‡ç”¨äº†äºŒåˆ†æ³•æŸ¥æ‰¾ï¼Œä½†è¿™æ ·è¿˜æ˜¯ä¸å¤Ÿè‡ªç”±ä¾¿åˆ©ï¼Œæœªæ¥ä¼šæ‰¾åˆ°æ›´å¥½çš„è¡¨æŸ¥æ‰¾ç»“æ„(æˆ–è®¸)ã€‚è¿™æ˜¯åº“å‡çº§çš„éš¾ç‚¹ï¼Œæœ‰æ–¹æ¡ˆçš„è¯·ä¸æˆ‘è”ç³»ï¼Œéå¸¸æ„Ÿè°¢ğŸ˜˜ï¼ 7. ğŸƒâ€â™€ï¸**å…‹åˆ¶çš„äº‹ä»¶å›è°ƒ**ï¼šå°‘é‡çš„å›è°ƒæœºåˆ¶ã€‚å°½å¯èƒ½ä½¿ç”¨æ ˆè½®è¯¢ï¼Œå°½å¯èƒ½å°‘åœ°å½±å“ç³»ç»Ÿæ—¶åºã€‚"},"/modbusX/zh_hans/apidoc/apimaster/MBx_Master_Member_Add.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Master_Member_Add ### source ```c uint32_t MBx_Master_Member_Add(_MBX_MASTER *MBxMaster, _MBX_MASTER_TEAM_MEMBER *MBxMember, uint8_t SlaveID, const _MBX_MAP_LIST_ENTRY *MAP ); ``` å‘ MBX ä¸»æœºå¯¹è±¡æ·»åŠ ä¸€ä¸ªæˆå‘˜ä»æœº ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›æ·»åŠ åˆ°çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆ > MBxMemberï¼šæœŸæœ›é…ç½®å¹¶æ·»åŠ è¿›çš„ä»æœºæˆå‘˜å¯¹è±¡æŒ‡é’ˆ > SlaveIDï¼šä»æœº ID ã€‚å°†é…ç½®ç»™ä»æœºæˆå‘˜ > MAPï¼šè¯¥å¤´æŒ‡é’ˆæŒ‡å‘ä»¥ MBX_MAP_LIST_END å®ä¸ºç»“å°¾çš„ list è¡¨ã€‚å®šä¹‰æ‰€æœ‰å¯èƒ½çš„åœ°å€ã€‚å°†é…ç½®ç»™ä»æœºæˆå‘˜ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å› > MBX_API_RETURN_ERR_PARAM(0x02)ï¼šä¼ å‚å¼‚å¸¸ï¼Œæ£€æŸ¥è°ƒç”¨æ—¶çš„ä¼ å‚ã€‚ > MBX_API_RETURN_MAP_UNFORMAT(0x101)ï¼šä¼ å…¥çš„MAPè¡¨ä¸è§„èŒƒ"},"/modbusX/zh_hans/apidoc/apislave/MBx_Slave_RTU_Init.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Slave_RTU_Init ### source ```c uint32_t MBx_Slave_RTU_Init(_MBX_SLAVE *MBxSlave, uint8_t SlaveID, const _MBX_MAP_LIST_ENTRY *MAP, MBX_SEND_PTR MBxSend, MBX_GTEC_PTR MBxGetc, uint32_t BaudRate, uint8_t *RxBuffer, uint32_t RxBufferSize, uint8_t *TxBuffer, uint32_t TxBufferSize ); ``` ä½œä¸º RTU åˆå§‹åŒ– MBX ä»æœºå¯¹è±¡ï¼Œå¹¶ä¼ å…¥å„ç§é…ç½®å‚æ•°å¯¹è¿™ä¸ª _MBX_SLAVE ç±»å‹ä»æœºå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚ ### ä¼ å‚ > MBxSlaveï¼šæœŸæœ›åˆå§‹åŒ–çš„ä»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šè¯¥ä»æœºå¯¹è±¡é…ç½®ä¸ºçš„ä»æœº ID ï¼ŒèŒƒå›´ 1~247 ã€‚ > MAPï¼šè¯¥å¤´æŒ‡é’ˆæŒ‡å‘ä»¥ MBX_MAP_LIST_END å®ä¸ºç»“å°¾çš„ list è¡¨ã€‚å®šä¹‰æ‰€æœ‰å¯èƒ½çš„åœ°å€ã€‚ > MBxSendï¼šå¦å®ç°çš„æ•°æ®å‘é€ port ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > MBxGetcï¼šå¦å®ç°çš„æ•°æ®æ¥æ”¶portï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > BaudRateï¼šå®é™…ä¸²è¡Œé“¾è·¯çš„æ³¢ç‰¹ç‡ï¼Œç”¨äºè‡ªåŠ¨è®¡ç®— 1.5 å­—ç¬¦å’Œ 3.5 å­—ç¬¦æ—¶é—´ã€‚ > RxBufferï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > RxBufferSizeï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†è§£æå•æ¡è¯·æ±‚çš„æœ€å¤§é•¿åº¦ã€‚ > TxBufferï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > TxBufferSizeï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†å‘é€å•æ¡å›å¤çš„æœ€å¤§é•¿åº¦ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å› > MBX_API_RETURN_MAP_UNFORMAT(0x101)ï¼šä¼ å…¥çš„MAPè¡¨ä¸è§„èŒƒ"},"/modbusX/zh_hans/apidoc/apislave/MBx_Slave_TCP_Init.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Slave_TCP_Init ### source ```c uint32_t MBx_Slave_TCP_Init(_MBX_SLAVE *MBxSlave, uint8_t SlaveID, const _MBX_MAP_LIST_ENTRY *MAP, MBX_SEND_PTR MBxSend, MBX_GTEC_PTR MBxGetc, uint8_t *RxBuffer, uint32_t RxBufferSize, uint8_t *TxBuffer, uint32_t TxBufferSize ); ``` ä½œä¸º TCP åˆå§‹åŒ– MBX ä»æœºå¯¹è±¡ï¼Œå¹¶ä¼ å…¥å„ç§é…ç½®å‚æ•°å¯¹è¿™ä¸ª _MBX_SLAVE ç±»å‹ä»æœºå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚ ### ä¼ å‚ > MBxSlaveï¼šæœŸæœ›åˆå§‹åŒ–çš„ä»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šè¯¥ä»æœºå¯¹è±¡é…ç½®ä¸ºçš„ä»æœº ID ï¼ŒèŒƒå›´ 1~247 ã€‚ > MAPï¼šè¯¥å¤´æŒ‡é’ˆæŒ‡å‘ä»¥ MBX_MAP_LIST_END å®ä¸ºç»“å°¾çš„ list è¡¨ã€‚å®šä¹‰æ‰€æœ‰å¯èƒ½çš„åœ°å€ã€‚ > MBxSendï¼šå¦å®ç°çš„æ•°æ®å‘é€ port ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > MBxGetcï¼šå¦å®ç°çš„æ•°æ®æ¥æ”¶portï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > RxBufferï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > RxBufferSizeï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†è§£æå•æ¡è¯·æ±‚çš„æœ€å¤§é•¿åº¦ã€‚ > TxBufferï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > TxBufferSizeï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†å‘é€å•æ¡å›å¤çš„æœ€å¤§é•¿åº¦ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å› > MBX_API_RETURN_MAP_UNFORMAT(0x101)ï¼šä¼ å…¥çš„MAPè¡¨ä¸è§„èŒƒ"},"/modbusX/zh_hans/apidoc/apigengric/Addr_Map.html":{"title":"","content":" class: heading_no_counter draft: false # åœ°å€è¡¨çš„åˆ¶ä½œ åº“çš„é‡è¦ç‰¹è‰²å°±æ˜¯å°† modbus åœ°å€å’Œå·²æœ‰å˜é‡æ˜ å°„èµ·æ¥ ![MBXæ¨¡å‹.png](https://cloudflare imgbed 6qt.pages.dev/file/1733793623876_MBXæ¨¡å‹.png) æ‰€ä»¥æ— è®ºä¸»æœºæˆ–ä»æœºï¼Œéƒ½éœ€è¦åˆ¶ä½œæ˜ å°„è¡¨ã€‚è¯¦æƒ…å»ºè®®å‚è§ [é¡¹ç›®è‡ªè¿°æ–‡ä»¶](https://github.com/stbanana/modbusX) ä¸­çš„åº“ä½¿ç”¨æ­¥éª¤ã€‚"},"/modbusX/zh_hans/apidoc/apigengric/MBx_Ticks.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Ticks ### source ```c void MBx_Ticks( uint32_t Cycle ); ``` å¿…é¡»å‘¨æœŸè°ƒç”¨, é©±åŠ¨ modbusX ç³»ç»Ÿçš„å…³é”®å‡½æ•°ã€‚æ— è®ºä¸»æœºè¿˜æ˜¯ä»æœºï¼Œå‡ç”±è¿™ä¸ªå”¯ä¸€çš„åº“tickè¿›è¡Œé©±åŠ¨ã€‚ ### ä¼ å‚ > Cycleï¼šè°ƒç”¨æœ¬å‡½æ•°çš„å‘¨æœŸå€¼us ### è¿”å›å€¼ > æ— è¿”å›"},"/modbusX/zh_hans/apidoc/tools/ç”¨æˆ·é…ç½®æ–‡ä»¶.html":{"title":"","content":" class: heading_no_counter draft: false # ç”¨æˆ·é…ç½®æ–‡ä»¶ ## é‡ç‚¹ åè®®æ ˆå¯¹åŠŸèƒ½çš„è£å‰ªå’Œé…ç½®åº”å½“æ˜¯å¾ˆå®¹æ˜“çš„äº‹æƒ…ï¼Œä»¥æ§åˆ¶è½¯ä»¶åŒ…çš„èµ„æºç”¨é‡ã€‚ åœ¨ `common/include` ä¸‹æœ‰ `MBx_user_sample.h` æ–‡ä»¶ï¼Œå°†å…¶å¤åˆ¶ä¸€ä»½å¹¶ä¸”é‡å‘½åä¸º `MBx_user.h` ï¼ŒåŠ å…¥å¯è¢« include æ‰¾åˆ°çš„è·¯å¾„ã€‚ åœ¨ç¼–è¯‘å…¨å±€ `define` å¢åŠ  **MBX_INCLUDE_USER_DEFINE_FILE** ï¼Œè¿™æ ·åº“å†…å°±ä¼šä½¿ç”¨ `MBx_user.h` çš„å„è‡ªå®šä¹‰è€Œéé»˜è®¤ã€‚ ç”±äºé…ç½®æ–‡ä»¶ç¬¦åˆ [CMSIS Configuration Wizard Annotations](https://open cmsis pack.github.io/Open CMSIS Pack Spec/main/html/configWizard.html)ï¼Œå¯ä»¥ä½¿ç”¨ `vscode` çš„æ’ä»¶æˆ–è€…å…¶ä»–æ–¹å¼å¯¹ `MBx_user.h` é…ç½®è¿›è¡Œæ¸²æŸ“ï¼Œè¿›è¡Œæ›´ç›´è§‚çš„é…ç½®ï¼Œæ¨èçš„æ–¹æ³•å°±æ˜¯ `vscode` çš„ `Arm CMSIS Solution` æ’ä»¶ å®‰è£…å®Œæˆï¼Œæ‰“å¼€ `MBx_user.h` æ–‡ä»¶åï¼Œç‚¹å‡»å³ä¸Šè§’çš„ \"Open Preview\" å›¾æ ‡ï¼Œå³å¯æ¸²æŸ“é…ç½®æ–‡ä»¶è¿›è¡Œå›¾å½¢åŒ–é…ç½®ã€‚ ![](https://cloudflare imgbed 6qt.pages.dev/file/1733310833976_é…ç½®æ¸²æŸ“å…¥å£å›¾æ ‡.png) ![](https://cloudflare imgbed 6qt.pages.dev/file/1733310836815_é…ç½®æ¸²æŸ“.png) ## é…ç½®ç»†åˆ™ ### MBX_SLAVE_ENABLE é»˜è®¤ 1 ä»æœºåŠŸèƒ½æ˜¯å¦å¼€å¯ 1åˆ™å¼€å¯ 0åˆ™è£å‰ªå»æ‰ä»æœºåŠŸèƒ½ ### MBX_MASTER_ENABLE é»˜è®¤ 1 ä¸»æœºåŠŸèƒ½æ˜¯å¦å¼€å¯ 1åˆ™å¼€å¯ 0åˆ™è£å‰ªå»æ‰ä¸»æœºåŠŸèƒ½ ### MBX_MODULE_TCP_MASTER_ENABLE é»˜è®¤ 1 å¦‚æœä½¿ç”¨ modbus TCP çš„ä¸»æœºåŠŸèƒ½éœ€è¦å°†è¿™ä¸ªå®ç½®ä¸º 1ï¼Œå¦åˆ™æ¨èæ˜¯ç½® 0ï¼Œä¼šæ˜æ˜¾å‡å°‘èµ„æºçš„å ç”¨(ä¸»è¦æ˜¯ RAM)ã€‚ ### MBX_MASTER_REQUEST_QUEUE_MAX é»˜è®¤ 40 ä¸»æœºè¯·æ±‚é˜Ÿåˆ—çš„æœ€å¤§å¯„å­˜æ¡æ•°ï¼Œç”¨äºè¿ç»­è¯»å†™è¯·æ±‚ï¼Œå¯„å­˜å¹¶è‡ªåŠ¨å‘é€å¤„ç†ã€‚æ­¤æ¡ä¼šæ˜¾è‘—å½±å“ RAM å ç”¨ã€‚ ### MBX_MASTER_MULTI_REG_MAX é»˜è®¤ 127 ä¸»æœºè¯»å†™å¤šä¸ªå¯„å­˜å™¨çš„æœ€å¤§ä¸ªæ•°ï¼Œç”¨äºè®¾å®šåº“å‘å‡ºçš„è¿ç»­è¯»æˆ–è¿ç»­å†™æŒ‡ä»¤ï¼Œæœ€å¤šå¯æŒ‡å®šå¤šå°‘ä¸ªå¯„å­˜å™¨ï¼Œæ­¤æ¡ä¼šæ˜¾è‘—å½±å“ RAM å ç”¨ã€‚ ### MBX_EXTEN_REG_HANDLE_ENABLE é»˜è®¤ 0 æ³¨æ„åˆ°åœ¨åº“å†…ç»™å‡ºçš„ä¾‹ç¨‹ï¼Œæ‰€æœ‰ä¸åŒçš„æ˜ å°„å˜é‡ï¼Œéœ€è¦ç‹¬ç«‹ä¸”å°½å¯èƒ½å”¯ä¸€çš„å¤„ç†å‡½æ•°ã€‚ å¦‚æœéœ€è¦åœ¨æŸä¸€ä¸ªå¤„ç†å‡½æ•°ä¸­å¤„ç†æ¥è‡ªä¸åŒçš„ modbus è™šæ‹Ÿåœ°å€çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªå®åº”è¯¥ç½®ä¸º 1ã€‚è¿™ä¸ªå®ç½® 1 åéœ€è¦æ›´æ”¹æ˜ å°„è¡¨çš„æ¡ç›®(æ¯ä¸ªæ¡ç›®å¢åŠ äº†ä¸€ä¸ªä¼ å‚é›†)ï¼Œå¹¶ä¸”æ¯ä¸ªå†™æ—¶å›è°ƒåº”è¯¥ä»¥æ–°çš„æ–¹å¼ç¼–å†™ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ã€‚ ä¸€ä¸ªæ˜æ˜¾çš„é€‚ç”¨åœºæ™¯æ˜¯ï¼Œä½œä¸º modbus ä»æœºï¼Œä½†è¿™ä¸ªä»æœºåªæ˜¯ä¸­é—´ä»¶ï¼Œéœ€è¦æ§åˆ¶å¤šä¸ªå®Œå…¨ç›¸åŒçš„æ¨¡å—å®ä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå®çš„å¼€å¯å°†æå¤§ç¼©å‡å·¥ä½œé‡å¹¶é™ä½ç»´æŠ¤éš¾åº¦ã€‚é’ˆå¯¹è¿™æ ·çš„åº”ç”¨åœºæ™¯æœ‰å¦‚ä¸‹çš„å®è·µæ¡ˆä¾‹ã€‚ **åŸæœ¬çš„éƒ¨åˆ†æ˜ å°„è¡¨**å¦‚ä¸‹ï¼Œè¿™ä¸‰ä¸ªåœ°å€åˆ†åˆ«æ§åˆ¶äº†ä¸‰ä¸ªå®Œå…¨ä¸€æ ·çš„æ¨¡å—ï¼Œ ```c {.Addr 0x2001, .Memory &(Powerflag[0]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower1,}, {.Addr 0x2011, .Memory &(Powerflag[1]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower2,}, {.Addr 0x2021, .Memory &(Powerflag[2]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower3,}, ``` éœ€è¦ç¼–å†™ä¸‰ä¸ªå‡ ä¹ä¸€è‡´çš„å›è°ƒï¼Œç±»ä¼¼å¦‚ä¸‹ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨å®ç”Ÿæˆå‡½æ•°ç­‰å…¶ä»–æ‰‹æ®µï¼Œä½†ä»ç„¶æ˜¯éš¾ä»¥ç»Ÿä¸€ç»´æŠ¤çš„ã€‚ ```c uint32_t ModbusModulePower1(void *value) { uint8_t ValueGet (*(uint8_t *)value); if(ValueGet > 0) { /* å¿½ç•¥ä¸€äº›å¼€æœºæ“ä½œ */ Powerflag[0] 1; } else { /* å¿½ç•¥ä¸€äº›å…³æœºæ“ä½œ */ Powerflag[0] 1; } return MBX_API_RETURN_DEFAULT; } ``` è€Œå¼€å¯è¿™ä¸ªå®åï¼Œéœ€è¦**æ›´æ–°è¿™éƒ¨åˆ†æ˜ å°„è¡¨**å¦‚ä¸‹ ```c const _MBX_REG_HANDLE_PARA MBXPara1 {.Para1 1, .Para2 1}; const _MBX_REG_HANDLE_PARA MBXPara2 {.Para1 2, .Para2 2}; const _MBX_REG_HANDLE_PARA MBXPara3 {.Para1 3, .Para2 3}; ...... {.Addr 0x2001, .Memory &(Powerflag[0]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower, .Para &MBXPara1}, {.Addr 0x2011, .Memory &(Powerflag[1]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower, .Para &MBXPara2}, {.Addr 0x2021, .Memory &(Powerflag[2]), .Type MBX_REG_TYPE_U8, .Handle ModbusModulePower, .Para &MBXPara3}, ``` è¿™é‡Œå¢åŠ äº†ä¸‰ä¸ªå…¨å±€é™æ€é‡ï¼Œä½œä¸ºå‚æ•°é›†ï¼ŒåŒæ—¶æ¯ä¸ªæ˜ å°„æ¡ç›®éœ€è¦å¢åŠ  `.Para` éƒ¨åˆ†çš„ç»‘å®šï¼Œè¿™ä¸ªå‚æ•°é›†ä¼šä¼ é€’ç»™å†™æ—¶å¤„ç†å‡½æ•°ï¼Œè¿™æ ·ä½¿å¾—ä¸‰ä¸ªå®Œå…¨ä¸€æ¨¡ä¸€æ ·çš„æ¨¡å—ä¸å¿…å®šä¹‰ä¸‰ä¸ªå‡ ä¹ä¸€æ ·çš„å¤„ç†å‡½æ•°ï¼Œè€Œå¯ä»¥è°ƒç”¨åŒä¸€ä¸ªï¼Œæ‰€ä»¥å¤„ç†å‡½æ•°çš„å®šä¹‰éœ€è¦æ›´æ–°ä¸ºå¦‚ä¸‹ ```c uint32_t ModbusModulePower(void *value, _MBX_REG_HANDLE_PARA *para) { uint8_t ValueGet (*(uint8_t *)value); if(ValueGet > 0) { /* æ‰§è¡Œ para >Para1 ç¼–å·æ¨¡å—çš„å¼€æœºæ“ä½œ */ Powerflag[para >Para1 1] 1; } else { /* æ‰§è¡Œ para >Para1 ç¼–å·æ¨¡å—çš„å…³æœºæ“ä½œ */ Powerflag[para >Para1 1] 1; } return MBX_API_RETURN_DEFAULT; } ``` å¯¹äºä¸ä½¿ç”¨è¿™ä¸ªä¼ å‚çš„æ¡ç›®ï¼Œæœ€ä½³æ–¹æ³•æ˜¯å°† `.Para &DefaultPara` è¿™ä¸ª `DefaultPara` æ˜¯ä¸€ä¸ªå¼€å¯å®åä¼šäº§ç”Ÿçš„é™æ€é‡ï¼Œé¿å…é‡æŒ‡é’ˆã€‚"},"/modbusX/zh_hans/apidoc/tools/èµ„æºå ç”¨æµ‹è¯•æŠ¥å‘Š.html":{"title":"","content":" class: heading_no_counter draft: false # èµ„æºå ç”¨æµ‹è¯•æŠ¥å‘Š ç»¼åˆæ¥çœ‹æœ‰ä»¥ä¸‹çš„èµ„æºå ç”¨æŠ¥å‘Š ROM \\ RAM (byte) O0 O3 åº“æœ¬ä½“ 20724 \\ 200 10360 \\ 204 1 ä¸ªä»æœºå¯¹è±¡ 988 \\ 80 632 \\ 80 1 ä¸ªæ˜ å°„æ¡ç›® (é™æ€) 20 \\ 0 20 \\ 0 1 ä¸ªä¸»æœºå¯¹è±¡ 908 \\ 21012 548 \\ 21016 ä¸»æœºæˆå‘˜ä»æœºå¯¹è±¡ï¼Œä¸ä»æœºå¯¹è±¡ç±»ä¼¼ æœªæµ‹è¯• æœªæµ‹è¯• é™¤æ­¤ä»¥å¤–ï¼Œä¸ºå¯¹è±¡å‡†å¤‡çš„æ”¶å‘ buffer ç©ºé—´ä¹Ÿä¼šå ç”¨å°‘é‡ RAM ï¼Œç¼–å†™å¤æ‚çš„å›è°ƒå‡½æ•°ä¼šå ç”¨å°‘é‡ ROM ï¼Œä½†è¿™äº›å¯ä»¥è‡ªå®šè‡ªæ§åˆ¶ã€‚ æ³¨æ„åˆ°æ•´ä¸ªåº“ï¼Œå¤§éƒ¨åˆ†çš„å†…å®¹éƒ½ä½¿ç”¨è¾ƒå°‘çš„èµ„æºï¼Œ**åªæœ‰ä¸»æœºå¯¹è±¡å ç”¨äº†å¤§é‡çš„ RAM**ï¼Œè¿™æ˜¯ç”±äºå¼€å¯äº†æ‰€æœ‰å ç”¨èµ„æºçš„é…ç½®é¡¹ã€‚ ä»¥ä¸‹ä¼šæœ‰ä¸€ä¸ªæ¨èçš„è£å‰ªè¿‡ç¨‹ã€‚ é»˜è®¤ç”¨æˆ·å·²ç»ç†Ÿè¯»äº†[ç”¨æˆ·é…ç½®æ–‡ä»¶](./ç”¨æˆ·é…ç½®æ–‡ä»¶.html) çš„å†…å®¹ï¼Œå¯¹äºèµ„æºå—é™çš„èŠ¯ç‰‡ï¼Œ > å°† **MBX_MODULE_TCP_MASTER_ENABLE** ç½®ä¸º 0 > å°† **MBX_MASTER_REQUEST_QUEUE_MAX** ç½®ä¸º 32 > å°† **MBX_MASTER_ERROR_QUEUE_MAX** ç½®ä¸º 1 > å°† **MBX_MASTER_MULTI_REG_MAX** ç½®ä¸º 20 ä¼šæ˜¾è‘—é™ä½ä¸ºè¿™æ ·çš„èµ„æºæ¶ˆè€— 0x2400001c g O .bss 0x00000638 MBxMaster RAM (byte) O0 O3 1 ä¸ªä¸»æœºå¯¹è±¡ 1592 1592 **å¼€å¯æ‰€æœ‰å ç”¨èµ„æºçš„é…ç½®é€‰é¡¹**ï¼Œæœ‰å¦‚ä¸‹ ROM \\ RAM (byte) O0 O3 : åŸºå‡†å‚è€ƒ1<br />(æ²¡æœ‰å¯åŠ¨æ–‡ä»¶) 96 \\ 28 96 \\ 28 åŸºå‡†å‚è€ƒ2<br />(å¸¦æœ‰å¯åŠ¨æ–‡ä»¶) 936 \\ 28 924 \\ 28 åº“æœ¬ä½“<br />(ä»…è°ƒç”¨åº“tick) 21660 \\ 228 11284 \\ 232 åº“æœ¬ä½“ + 1 ä¸ªä»æœºå¯¹è±¡<br />(æ— æ˜ å°„æ¡ç›®æ— æ”¶å‘buffer) 22648 \\ 308 11916 \\ 308 åº“æœ¬ä½“ + 1 ä¸ªä»æœºå¯¹è±¡ +<br />1 ä¸ªæ˜ å°„æ¡ç›® <br />(æ— æ”¶å‘buffer)) 22668 \\ 308 11936 \\ 308 åº“æœ¬ä½“ + 1 ä¸ªä»æœºå¯¹è±¡ +<br />1 ä¸ªæ˜ å°„æ¡ç›® + 1 ä¸ªç®€å•å›è°ƒ<br />(æ— æ”¶å‘buffer)) 22700 \\ 308 11940 \\ 308 åº“æœ¬ä½“ + 1 ä¸ªä¸»æœºå¯¹è±¡ <br />(æ— æ”¶å‘bufferï¼Œæ— ä»æœºæˆå‘˜)) 22568 \\ 21240 11832 \\ 21244 ## åŸºå‡†å‚è€ƒ1 åªé“¾æ¥äº†å¿…è¦åº“çš„ç©ºé¡¹ç›®ï¼Œæ²¡æœ‰å¯åŠ¨æ–‡ä»¶ï¼Œæ— æ³•é“¾æ¥å‡ºå®é™…äº§ç‰© ### O0 ä¼˜åŒ– ```sh [build] c:/111_apps/msys2/mingw64/bin/../lib/gcc/arm none eabi/12.2.0/../../../../arm none eabi/bin/ld.exe: warning: cannot find entry symbol Reset_Handler; defaulting to 08020000 [build] Memory region Used Size Region Size %age Used [build] FLASH: 96 B 2 MB 0.00% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 28 B 512 KB 0.01% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### 03ä¼˜åŒ– ```sh [build] c:/111_apps/msys2/mingw64/bin/../lib/gcc/arm none eabi/12.2.0/../../../../arm none eabi/bin/ld.exe: warning: cannot find entry symbol Reset_Handler; defaulting to 08020000 [build] Memory region Used Size Region Size %age Used [build] FLASH: 96 B 2 MB 0.00% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 28 B 512 KB 0.01% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## åŸºå‡†å‚è€ƒ2 åªé“¾æ¥äº†å¿…è¦åº“çš„ç©ºé¡¹ç›®ï¼Œæœ‰å¯åŠ¨æ–‡ä»¶ï¼Œé“¾æ¥å‡ºå®é™…äº§ç‰© ### O0 ä¼˜åŒ– ```sh [build] [100%] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 936 B 2 MB 0.04% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 28 B 512 KB 0.01% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### 03ä¼˜åŒ– ```sh [build] [4/4 100% :: 1.100] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 924 B 2 MB 0.04% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 28 B 512 KB 0.01% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## åº“æœ¬ä½“èµ„æºå ç”¨ ä»¥ä¸‹ä»£ç æµ‹è¯•(ä¸å±•ç¤ºå¯åŠ¨æ–‡ä»¶) ```c #include <MBx_api.h> // int main( ) { MBx_Ticks(1); return 0; } ``` ARM GCC ç¼–è¯‘æµ‹è¯•ï¼Œåº“æœ¬ä½“ï¼Œè€Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªä¸»ä»æœºå¯¹è±¡ ### O0 ä¼˜åŒ– å ç”¨ 21468 å­—èŠ‚ ROM ï¼Œ200 å­—èŠ‚ RAM å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [100%] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 21660 B 2 MB 1.03% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 228 B 512 KB 0.04% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### 03ä¼˜åŒ– å ç”¨ 11188 å­—èŠ‚ ROM ï¼Œ204 å­—èŠ‚ RAM å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [100%] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 11284 B 2 MB 0.54% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 232 B 512 KB 0.04% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## ä¸€ä¸ªä»æœºå¯¹è±¡ï¼Œç®€å•portï¼Œç©ºæ˜ å°„è¡¨ ä»¥ä¸‹ä»£ç æµ‹è¯•(ä¸å±•ç¤ºå¯åŠ¨æ–‡ä»¶) ```c #include <MBx_api.h> static const _MBX_MAP_LIST_ENTRY MapList[]; _MBX_SLAVE MBxSlave; // uint32_t SendPort(const void *Data, size_t Len) { return MBX_PORT_RETURN_DEFAULT; } uint32_t GetcPort(uint8_t *Data) { return MBX_PORT_RETURN_DEFAULT; } // int main( ) { /* åˆå§‹åŒ–modbusä»æœº1 */ if(MBx_Slave_RTU_Init(&MBxSlave, // ä»æœºå¯¹è±¡ 1, // ä»æœºID MapList, // åœ°å€æ˜ å°„è¡¨ SendPort, // å‘é€å‡½æ•° GetcPort, // æ¥æ”¶å‡½æ•° 9600, // æ³¢ç‰¹ç‡ NULL, // åº“å†…æ¥æ”¶bufferåˆ†é… 84, // æ¥æ”¶bufferæœ€å¤§é•¿åº¦ NULL, // åº“å†…å‘é€bufferåˆ†é… 84) // å‘é€bufferæœ€å¤§é•¿åº¦ ! MBX_API_RETURN_DEFAULT) { /* åˆå§‹åŒ–é”™è¯¯ è‡ªè¡Œåˆ¤æ–­è¿”å›å€¼å·®é”™ */ } MBx_Ticks(1); return 0; } static const _MBX_MAP_LIST_ENTRY MapList[] { MBX_MAP_LIST_END }; ``` ### O0 ä¼˜åŒ– å ç”¨ 22552 å­—èŠ‚ ROM ï¼Œ280 å­—èŠ‚ RAM ```sh [build] [100%] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 22648 B 2 MB 1.08% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### O3ä¼˜åŒ– å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [ 4%] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 11916 B 2 MB 0.57% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## ä¸€ä¸ªä»æœºå¯¹è±¡ï¼Œç®€å•portï¼Œä¸€ä¸ªæ¡ç›®æ˜ å°„è¡¨ï¼Œæ— å®é™…å›è°ƒå‡½æ•° ä»¥ä¸‹æµ‹è¯•ä»£ç (ä¸å±•ç¤ºå¯åŠ¨æ–‡ä»¶) ```c #include <MBx_api.h> static const _MBX_MAP_LIST_ENTRY MapList[]; _MBX_SLAVE MBxSlave; // uint32_t SendPort(const void *Data, size_t Len) { return MBX_PORT_RETURN_DEFAULT; } uint32_t GetcPort(uint8_t *Data) { return MBX_PORT_RETURN_DEFAULT; } // int main( ) { /* åˆå§‹åŒ–modbusä»æœº1 */ if(MBx_Slave_RTU_Init(&MBxSlave, // ä»æœºå¯¹è±¡ 1, // ä»æœºID MapList, // åœ°å€æ˜ å°„è¡¨ SendPort, // å‘é€å‡½æ•° GetcPort, // æ¥æ”¶å‡½æ•° 9600, // æ³¢ç‰¹ç‡ NULL, // åº“å†…æ¥æ”¶bufferåˆ†é… 84, // æ¥æ”¶bufferæœ€å¤§é•¿åº¦ NULL, // åº“å†…å‘é€bufferåˆ†é… 84) // å‘é€bufferæœ€å¤§é•¿åº¦ ! MBX_API_RETURN_DEFAULT) { /* åˆå§‹åŒ–é”™è¯¯ è‡ªè¡Œåˆ¤æ–­è¿”å›å€¼å·®é”™ */ } MBx_Ticks(1); return 0; } static const _MBX_MAP_LIST_ENTRY MapList[] { {.Addr 0x0001, .Memory &(MBxSlave.Config.MapNum), .Type MBX_REG_TYPE_U16, .Handle NULL, .Para &DefaultPara}, MBX_MAP_LIST_END }; ``` ### O0 ä¼˜åŒ– ```sh [build] [43/43 100% :: 2.018] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 22668 B 2 MB 1.08% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### O3ä¼˜åŒ– å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [2/2 100% :: 1.049] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 11936 B 2 MB 0.57% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## ä¸€ä¸ªä»æœºå¯¹è±¡ï¼Œç®€å•portï¼Œæ— ä»æœºæˆå‘˜å¯¹è±¡ï¼Œæ— å®é™…å›è°ƒå‡½æ•° ä»¥ä¸‹æµ‹è¯•ä»£ç (ä¸å±•ç¤ºå¯åŠ¨æ–‡ä»¶) ```c #include <MBx_api.h> static const _MBX_MAP_LIST_ENTRY MapList[]; _MBX_SLAVE MBxSlave; // uint32_t SendPort(const void *Data, size_t Len) { return MBX_PORT_RETURN_DEFAULT; } uint32_t GetcPort(uint8_t *Data) { return MBX_PORT_RETURN_DEFAULT; } uint32_t ModbusSetFoo(void *value, _MBX_REG_HANDLE_PARA *para) { int16_t ValueGet (*(int16_t *)value); return MBX_API_RETURN_DEFAULT; } // int main( ) { /* åˆå§‹åŒ–modbusä»æœº1 */ if(MBx_Slave_RTU_Init(&MBxSlave, // ä»æœºå¯¹è±¡ 1, // ä»æœºID MapList, // åœ°å€æ˜ å°„è¡¨ SendPort, // å‘é€å‡½æ•° GetcPort, // æ¥æ”¶å‡½æ•° 9600, // æ³¢ç‰¹ç‡ NULL, // åº“å†…æ¥æ”¶bufferåˆ†é… 84, // æ¥æ”¶bufferæœ€å¤§é•¿åº¦ NULL, // åº“å†…å‘é€bufferåˆ†é… 84) // å‘é€bufferæœ€å¤§é•¿åº¦ ! MBX_API_RETURN_DEFAULT) { /* åˆå§‹åŒ–é”™è¯¯ è‡ªè¡Œåˆ¤æ–­è¿”å›å€¼å·®é”™ */ } MBx_Ticks(1); return 0; } static const _MBX_MAP_LIST_ENTRY MapList[] { {.Addr 0x0001, .Memory &(MBxSlave.Config.MapNum), .Type MBX_REG_TYPE_U16, .Handle ModbusSetFoo, .Para &DefaultPara}, MBX_MAP_LIST_END }; ``` ### O0 ä¼˜åŒ– ```sh [build] [2/2 100% :: 1.197] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 22700 B 2 MB 1.08% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### O3ä¼˜åŒ– å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [43/43 100% :: 2.079] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 11940 B 2 MB 0.57% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 308 B 512 KB 0.06% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ## ä¸€ä¸ªä¸»æœºå¯¹è±¡ï¼Œç®€å•portï¼Œä¸€ä¸ªæ¡ç›®æ˜ å°„è¡¨ï¼Œä¸€ä¸ªå®é™…å›è°ƒå‡½æ•° ä»¥ä¸‹æµ‹è¯•ä»£ç (ä¸å±•ç¤ºå¯åŠ¨æ–‡ä»¶) ```c #include <MBx_api.h> _MBX_MASTER MBxMaster; // uint32_t SendPort(const void *Data, size_t Len) { return MBX_PORT_RETURN_DEFAULT; } uint32_t GetcPort(uint8_t *Data) { return MBX_PORT_RETURN_DEFAULT; } int main( ) { /* åˆå§‹åŒ–modbusä¸»æœº1 */ if(MBx_Master_RTU_Init(&MBxMaster, // ä¸»æœºå¯¹è±¡ SendPort, // å‘é€å‡½æ•° GetcPort, // æ¥æ”¶å‡½æ•° 9600, // æ³¢ç‰¹ç‡ NULL, // åº“å†…æ¥æ”¶bufferåˆ†é… 84, // æ¥æ”¶bufferæœ€å¤§é•¿åº¦ NULL, // åº“å†…å‘é€bufferåˆ†é… 84) // å‘é€bufferæœ€å¤§é•¿åº¦ ! MBX_API_RETURN_DEFAULT) { /* åˆå§‹åŒ–é”™è¯¯ è‡ªè¡Œåˆ¤æ–­è¿”å›å€¼å·®é”™ */ } MBx_Ticks(1); return 0; } ``` ### O0 ä¼˜åŒ– ```sh [build] [43/43 100% :: 2.056] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 22568 B 2 MB 1.08% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 21240 B 512 KB 4.05% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ``` ### O3ä¼˜åŒ– å…·å¤‡å¯åŠ¨æ–‡ä»¶å’Œmainå‡½æ•°ï¼Œåœ¨é…ç½®æ–‡ä»¶å¼€å¯äº†å®Œå…¨çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ ```sh [build] [43/43 100% :: 2.164] Linking C executable arm size test.elf [build] Memory region Used Size Region Size %age Used [build] FLASH: 11832 B 2 MB 0.56% [build] RAM_BLFlag: 0 GB 4 B 0.00% [build] DTCMRAM: 1540 B 131068 B 1.17% [build] RAM_D1: 21244 B 512 KB 4.05% [build] RAM_D2: 0 GB 288 KB 0.00% [build] RAM_D3: 0 GB 64 KB 0.00% ```"},"/modbusX/zh_hans/index.html":{"title":"","content":" update: date: 2024 12 07 author: yono version: 0.3.0 content: å®Œæˆ gitbook åˆ° teedoc çš„è¿ç§» update_open: true # è§„èŒƒ æ–‡æ¡£æ’ç‰ˆç¬¦åˆ [ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ— (github.com)](https://github.com/sparanoid/chinese copywriting guidelines) å¼€æºåè®®ç¬¦åˆ [MIT License (mit license.org)](https://mit license.org/) å®ç° MODBUS åè®®åº“ç¬¦åˆ [MODBUS Application Protocol 1 1 b](https://modbus.org/docs/Modbus_Application_Protocol_V1_1b3.pdf) é…ç½®æ–‡ä»¶ç¬¦åˆ [CMSIS Configuration Wizard Annotations](https://open cmsis pack.github.io/Open CMSIS Pack Spec/main/html/configWizard.html)"},"/modbusX/zh_hans/apidoc/apimaster/Master2Slave.html":{"title":"","content":" class: heading_no_counter draft: false # å¯¹ä»æœºå‘èµ·è¯·æ±‚ ç³»åˆ—API ## **MBx_Master_Read_Coil_Request** ```c uint32_t MBx_Master_Read_Coil_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t ReadNum); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡è¯»çº¿åœˆè¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šè¯»å–èµ·å§‹åœ°å€ã€‚ > ReadNumï¼šè¯»å–æ•°é‡ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Read_Disc_Input_Request** ```c uint32_t MBx_Master_Read_Disc_Input_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t ReadNum); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡è¯»ç¦»æ•£è¾“å…¥è¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šè¯»å–èµ·å§‹åœ°å€ã€‚ > ReadNumï¼šè¯»å–æ•°é‡ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Read_Reg_Request** ```c uint32_t MBx_Master_Read_Reg_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t ReadNum); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡è¯»ä¿æŒå¯„å­˜å™¨è¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šè¯»å–èµ·å§‹åœ°å€ã€‚ > ReadNumï¼šè¯»å–æ•°é‡ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Read_Input_Reg_Request** ```c uint32_t MBx_Master_Read_Input_Reg_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t ReadNum); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡è¯»è¾“å…¥å¯„å­˜å™¨è¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šè¯»å–èµ·å§‹åœ°å€ã€‚ > ReadNumï¼šè¯»å–æ•°é‡ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Write_Coil_Request** ```c uint32_t MBx_Master_Write_Coil_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t Addr, uint16_t Value); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡å†™å•ä¸ªçº¿åœˆè¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > Addrï¼šå†™å…¥åœ°å€ã€‚ > Valueï¼šå†™å…¥å€¼ã€‚å†™å…¥çº¿åœˆï¼Œæœ¬è´¨ä¸Šåªæœ‰0ä¸å¤§äº0ï¼Œç¨‹åºä¼šè‡ªåŠ¨å¤„ç†æ ¼å¼åŒ–è¯·æ±‚ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Write_Reg_Request** ```c uint32_t MBx_Master_Write_Reg_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t Addr, uint16_t Value); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡å†™å•ä¸ªä¿æŒå¯„å­˜å™¨è¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > Addrï¼šå†™å…¥åœ°å€ã€‚ > Valueï¼šå†™å…¥å€¼ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Write_Coil_Mul_Request** ```c uint32_t MBx_Master_Write_Coil_Mul_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t WriteNum, uint8_t *Data, uint16_t DataLen); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡å†™å¤šä¸ªçº¿åœˆè¯·æ±‚ ï¼ŒDataã€DataLenä¼ å‚éœ€è¦è‡ªè¡Œæ ¼å¼åŒ– è§å…¶ä¸­å…³äº\"(0x0F)å†™å¤šä¸ªçº¿åœˆçš„æ ¼å¼ \" [modbusåè®®ä»‹ç» ](https://www.yono233.cn/posts/shoot/24_7_26_modbusåè®®ä»‹ç»(æœªå®Œæˆ)) ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šå†™å…¥èµ·å§‹åœ°å€ã€‚ > WriteNumï¼šå†™å…¥æ•°é‡ã€‚ > Dataï¼šå†™å…¥æ•°æ®èµ·å§‹æŒ‡é’ˆã€‚ > DataLenï¼šå†™å…¥æ•°æ®é•¿åº¦[å­—èŠ‚æ•°]ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ ## **MBx_Master_Write_Reg_Mul_Request** ```c uint32_t MBx_Master_Write_Reg_Mul_Request(_MBX_MASTER *pMaster, uint8_t SlaveID, uint16_t StartAddr, uint16_t WriteNum, uint8_t *Data, uint16_t DataLen); ``` MBX ä¸»æœºå‘å‡ºä¸€æ¡å†™å¤šä¸ªä¿æŒå¯„å­˜å™¨è¯·æ±‚ ### ä¼ å‚ > MBxMasterï¼šæœŸæœ›å‘å‡ºè¯·æ±‚çš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > SlaveIDï¼šæœŸæœ›è¯·æ±‚çš„ä»æœºå·ã€‚ > StartAddrï¼šå†™å…¥èµ·å§‹åœ°å€ã€‚ > WriteNumï¼šå†™å…¥æ•°é‡ã€‚ > Dataï¼šå†™å…¥æ•°æ®èµ·å§‹æŒ‡é’ˆã€‚ > DataLenï¼šå†™å…¥æ•°æ®é•¿åº¦[å­—èŠ‚æ•°]ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_FULL(0x20)ï¼šé˜Ÿåˆ—å·²æ»¡ã€‚ > MBX_API_RETURN_MAP_UNFIND(0x102)ï¼šæœªæŸ¥æ‰¾åˆ°åˆé€‚çš„MAPï¼Œé€šå¸¸æ„å‘³ç€ä»æœºå·é”™è¯¯ã€æˆ–è¯·æ±‚åœ°å€åœ¨åœ°å€æ˜ å°„è¡¨ä¸­æœªå®šä¹‰ã€‚ "},"/modbusX/zh_hans/apidoc/apimaster/MBx_Master_RTU_Init.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Master_RTU_Init ### source ```c uint32_t MBx_Master_RTU_Init(_MBX_MASTER *MBxMaster, MBX_SEND_PTR MBxSend, MBX_GTEC_PTR MBxGetc, uint32_t BaudRate, uint8_t *RxBuffer, uint32_t RxBufferSize, uint8_t *TxBuffer, uint32_t TxBufferSize ); ``` ä½œä¸º RTU åˆå§‹åŒ– MBX ä¸»æœºå¯¹è±¡ï¼Œå¹¶ä¼ å…¥å„ç§é…ç½®å‚æ•°å¯¹è¿™ä¸ª _MBX_MASTER ç±»å‹ä¸»æœºå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚ ### ä¼ å‚ > MBxSlaveï¼šæœŸæœ›åˆå§‹åŒ–çš„ä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > MBxSendï¼šå¦å®ç°çš„æ•°æ®å‘é€ port ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > MBxGetcï¼šå¦å®ç°çš„æ•°æ®æ¥æ”¶portï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > BaudRateï¼šå®é™…ä¸²è¡Œé“¾è·¯çš„æ³¢ç‰¹ç‡ï¼Œç”¨äºè‡ªåŠ¨è®¡ç®— 1.5 å­—ç¬¦å’Œ 3.5 å­—ç¬¦æ—¶é—´ã€‚ > RxBufferï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > RxBufferSizeï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†è§£æå•æ¡ä»æœºå›å¤çš„æœ€å¤§é•¿åº¦ã€‚ > TxBufferï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > TxBufferSizeï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†å‘é€å•æ¡ä¸»æœºè¯·æ±‚çš„æœ€å¤§é•¿åº¦ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å› > MBX_API_RETURN_ERR_PARAM(0x02)ï¼šä¼ å‚å¼‚å¸¸ï¼Œæ£€æŸ¥è°ƒç”¨æ—¶çš„ä¼ å‚ã€‚"},"/modbusX/zh_hans/apidoc/apimaster/MBx_Master_TCP_Init.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Master_TCP_Init ### source ```c uint32_t MBx_Master_RTU_Init(_MBX_MASTER *MBxMaster, MBX_SEND_PTR MBxSend, MBX_GTEC_PTR MBxGetc, uint32_t BaudRate, uint8_t *RxBuffer, uint32_t RxBufferSize, uint8_t *TxBuffer, uint32_t TxBufferSize ); ``` ä½œä¸º TCP åˆå§‹åŒ– MBX ä¸»æœºå¯¹è±¡ï¼Œå¹¶ä¼ å…¥å„ç§é…ç½®å‚æ•°å¯¹è¿™ä¸ª _MBX_MASTER ç±»å‹ä¸»æœºå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚ ### ä¼ å‚ > MBxSlaveï¼šæœŸæœ›åˆå§‹åŒ–çš„ä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > MBxSendï¼šå¦å®ç°çš„æ•°æ®å‘é€ port ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > MBxGetcï¼šå¦å®ç°çš„æ•°æ®æ¥æ”¶portï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ > RxBufferï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > RxBufferSizeï¼šç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†è§£æå•æ¡ä»æœºå›å¤çš„æœ€å¤§é•¿åº¦ã€‚ > TxBufferï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„ä¸€æ®µå†…å­˜ç©ºé—´å¤´æŒ‡é’ˆã€‚ > TxBufferSizeï¼šç”¨äºå­˜æ”¾å‘é€æ•°æ®çš„å†…å­˜ç©ºé—´æ€»é•¿åº¦ã€‚è¿™ä¸ªå†…å­˜ç©ºé—´å†³å®šäº†å‘é€å•æ¡ä¸»æœºè¯·æ±‚çš„æœ€å¤§é•¿åº¦ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å› > MBX_API_RETURN_ERR_PARAM(0x02)ï¼šä¼ å‚å¼‚å¸¸ï¼Œæ£€æŸ¥è°ƒç”¨æ—¶çš„ä¼ å‚ã€‚"},"/modbusX/zh_hans/apidoc/apimaster/MBx_Master_Error_Get.html":{"title":"","content":" class: heading_no_counter draft: false # MBx_Master_Error_Get ### source ```c uint32_t MBx_Master_Error_Get(_MBX_MASTER *pMaster, uint8_t *Func, uint8_t *Error, uint16_t *AddrStart, uint16_t *RegNum ); ``` ä» MBX ä¸»æœºé”™è¯¯é˜Ÿåˆ—ä¸­è·å¾—ä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯æ¥æ”¶åˆ°çš„ä»æœºé”™è¯¯ç ã€‚ ### ä¼ å‚ > pMasterï¼šæœŸæœ›æ“ä½œçš„MBXä¸»æœºå¯¹è±¡æŒ‡é’ˆã€‚ > Funcï¼šè¯¥é”™è¯¯æŒ‡ä»¤ï¼Œå‘é€æ—¶åŠŸèƒ½ç ã€‚ > Errorï¼šå®é™…æ”¶åˆ°çš„é”™è¯¯ç ã€‚ > AddrStartï¼šè¯¥é”™è¯¯æŒ‡ä»¤ï¼Œå‘é€æ—¶æ“ä½œçš„èµ·å§‹åœ°å€ã€‚ > RegNumï¼šè¯¥é”™è¯¯æŒ‡ä»¤ï¼Œå‘é€æ—¶æ“ä½œçš„å¯„å­˜å™¨æ•°é‡ã€‚ ### è¿”å›å€¼ > MBX_API_RETURN_DEFAULT(0x00)ï¼šæ­£å¸¸è¿”å›ã€‚ > MBX_API_RETURN_BUFFER_EMPTY(0x21)ï¼šé˜Ÿåˆ—ä¸ºç©ºã€‚"}}